#  DeepLearning.AI - P2：2——模型，提示和输出解析 - 吴恩达大模型 - BV1iZ421M79T

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_0.png)

第一课，第一课。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_2.png)

将涵盖模型，将涵盖模型，提示和解析器，提示和解析器，所以模型指语言模型，所以模型指语言模型，支撑很多方面，支撑很多方面，提示指创建输入的风格，提示指创建输入的风格，然后解析器在另一端。

然后解析器在另一端，涉及将模型输出解析为更结构化的格式，涉及将模型输出解析为更结构化的格式，以便下游使用，以便下游使用，所以当你使用lm构建应用时，所以当你使用lm构建应用时，通常会有可重用模型。

通常会有可重用模型，我们反复提示模型，我们反复提示模型，解析输出，解析输出，因此启动提供了一组简单的抽象来执行此类操作，因此启动提供了一组简单的抽象来执行此类操作。

所以让我们深入了解一下模型、提示和解析器，所以让我们深入了解一下模型、提示和解析器，要开始，要开始。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_4.png)

这里是一些起始代码，这里是一些起始代码，我将导入os、openai并加载我的openai密钥，我将导入os、openai并加载我的openai密钥。

openai库已经安装在我的jupyter笔记本环境中，openai库已经安装在我的jupyter笔记本环境中。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_6.png)

如果你本地运行并且还没有安装open ai，如果你本地运行并且还没有安装open ai。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_8.png)

你可能需要运行pip，你可能需要运行pip，安装open ai，安装open ai。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_10.png)

但我不在这里做，但我不在这里做，然后这是一个辅助函数，然后这是一个辅助函数，这实际上与你在聊天，这实际上与你在聊天，Gpt提示工程开发人员，Gpt提示工程开发人员，课程中看到的辅助函数非常相似。

课程中看到的辅助函数非常相似。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_12.png)

我与open eyes一起提供的fulford，我与open eyes一起提供的fulford。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_14.png)

所以使用这个辅助函数你可以说完成1加1是什么，所以使用这个辅助函数你可以说完成1加1是什么，这将调用try gpc，这将调用try gpc，或技术上模型gpt三点五 turbo给你答案。

或技术上模型gpt三点五 turbo给你答案。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_16.png)

像这样现在为了激励，像这样现在为了激励。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_18.png)

模型提示和解析器的抽象，模型提示和解析器的抽象。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_20.png)

假设你收到一封非英语客户的电子邮件，假设你收到一封非英语客户的电子邮件，嗯，嗯，为确保可访问性，为确保可访问性。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_22.png)

我将使用的另一种语言是英语海盗语言，我将使用的另一种语言是英语海盗语言，当涉及到r时，当涉及到r时，我会很生气，我会很生气。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_24.png)

我的搅拌机盖子飞掉并把我的厨房墙溅满了奶昔，我的搅拌机盖子飞掉并把我的厨房墙溅满了奶昔，更糟糕的是，更糟糕的是。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_26.png)

保修不包括清理厨房的费用，保修不包括清理厨房的费用，我现在需要你的帮助，我现在需要你的帮助，伙计，伙计。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_28.png)

因此我们将要求这个lm将文本翻译成美式英语，因此我们将要求这个lm将文本翻译成美式英语，以冷静和尊重的语气，以冷静和尊重的语气，因此我将将样式设置为美式英语，语气常见且尊重。

因此我将将样式设置为美式英语，语气常见且尊重。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_30.png)

为了实际完成这个，为了实际完成这个，如果你之前看过一些提示，如果你之前看过一些提示。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_32.png)

我将使用f字符串指定提示，包含指令，我将使用f字符串指定提示，包含指令。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_34.png)

然后插入这两种样式，然后插入这两种样式，因此生成提示说，因此生成提示说。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_36.png)

翻译文本等，翻译文本等。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_38.png)

我建议你暂停视频并运行代码，我建议你暂停视频并运行代码，也尝试修改提示以查看是否可以得到不同的输出，也尝试修改提示以查看是否可以得到不同的输出。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_40.png)

你可以，你可以。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_42.png)

然后提示大型语言模型以获取响应，然后提示大型语言模型以获取响应。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_44.png)

让我们看看响应是什么，让我们看看响应是什么，所以它将英语海盗的消息翻译成这种非常礼貌的，所以它将英语海盗的消息翻译成这种非常礼貌的。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_46.png)

我真的很沮丧，我的搅拌机盖飞掉了，我真的很沮丧，我的搅拌机盖飞掉了。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_48.png)

把我的厨房墙搞得一团糟，把我的厨房墙搞得一团糟，如此顺滑的奶昔等，如此顺滑的奶昔等，我现在真的需要你的帮助，我现在真的需要你的帮助。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_50.png)

我的朋友那听起来很好，我的朋友那听起来很好，所以如果你有不同的客户用不同的语言写评论，所以如果你有不同的客户用不同的语言写评论。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_52.png)

不仅仅是英语海盗，不仅仅是英语海盗，而是法语，而是法语，德语，德语。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_54.png)

日语等等，日语等等，你可以想象需要生成一整序列的提示来生成这样的翻译，你可以想象需要生成一整序列的提示来生成这样的翻译。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_56.png)

让我们看看如何以更方便的方式做到这一点，让我们看看如何以更方便的方式做到这一点，使用lang chain，使用lang chain。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_58.png)

我将导入chat openai，我将导入chat openai，这是lang cha对chat gpt API端点的抽象，这是lang cha对chat gpt API端点的抽象。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_60.png)

因此如果我然后说had等于chat open ai并查看chat是什么，因此如果我然后说had等于chat open ai并查看chat是什么。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_62.png)

它创建了这个对象如下，它创建了这个对象如下，它使用chat gpt模型，它使用chat gpt模型，也称为gpt三点五 turbo，也称为gpt三点五 turbo。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_64.png)

当我构建应用程序时，当我构建应用程序时，我经常会将温度参数设置为等于零，我经常会将温度参数设置为等于零。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_66.png)

所以默认温度是零点七，所以默认温度是零点七，但让我实际上重新做一下，温度，但让我实际上重新做一下，温度，等于零点零，等于零点零，现在温度被设置为零以使其输出稍微少一些随机。

现在温度被设置为零以使其输出稍微少一些随机。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_68.png)

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_69.png)

现在让我定义模板字符串如下，现在让我定义模板字符串如下。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_71.png)

将文本翻译成由样式指定的样式，将文本翻译成由样式指定的样式，然后这里是文本，然后这里是文本。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_73.png)

为了反复重用此模板，为了反复重用此模板，让我们导入lang chains，让我们导入lang chains，聊天提示模板，聊天提示模板。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_75.png)

然后让我使用上面编写的模板字符串创建提示模板，然后让我使用上面编写的模板字符串创建提示模板。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_77.png)

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_78.png)

从提示模板，从提示模板，你可以实际提取原始提示，你可以实际提取原始提示，它意识到这个提示有两个输入变量，它意识到这个提示有两个输入变量，样式和文本，如这里用花括号所示，样式和文本，如这里用花括号所示。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_80.png)

这里是原始模板，我们实际上也指定了，这里是原始模板，我们实际上也指定了。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_82.png)

嗯，嗯，它意识到有两个输入变量，它意识到有两个输入变量。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_84.png)

样式和文本，样式和文本，现在，现在，确定风格，确定风格，这是客户消息要翻译成的风格，这是客户消息要翻译成的风格，我将称之为客户风格，我将称之为客户风格，这是我之前的客户电子邮件，现在。

这是我之前的客户电子邮件，现在。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_86.png)

如果我创建自定义消息，如果我创建自定义消息，这将生成提示，这将生成提示。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_88.png)

我们将传递这个，我们将传递这个，一分钟后的大语言模型以获取响应，一分钟后的大语言模型以获取响应，所以如果你想看类型，所以如果你想看类型，自定义消息实际上是一个列表，自定义消息实际上是一个列表，嗯，嗯。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_90.png)

如果你看列表的第一个元素，如果你看列表的第一个元素，这基本上是您期望它创建的最后提示，这基本上是您期望它创建的最后提示。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_92.png)

让我们将这个提示传递给LM，让我们将这个提示传递给LM。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_94.png)

因此我将调用聊天，因此我将调用聊天，我们之前说过，我们之前说过，嗯，嗯，作为对OpenAI GPT端点的引用，作为对OpenAI GPT端点的引用。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_96.png)

如果我们打印出客户响应内容，如果我们打印出客户响应内容，那么它会给你回，那么它会给你回，嗯，嗯，从英语海盗翻译成礼貌的美国英语，从英语海盗翻译成礼貌的美国英语，当然你可以想象其他用例。

客户电子邮件是其他语言的，当然你可以想象其他用例，客户电子邮件是其他语言的。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_98.png)

这两个可以用于将消息翻译成英语，这两个可以用于将消息翻译成英语。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_100.png)

说英语的人理解和回复，说英语的人理解和回复，我建议你暂停视频并运行代码，我建议你暂停视频并运行代码，并尝试修改提示以查看您是否可以获得不同的输出现在，并尝试修改提示以查看您是否可以获得不同的输出现在。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_102.png)

希望我们的客户服务代理用他们的原始语言回复了客户，希望我们的客户服务代理用他们的原始语言回复了客户。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_104.png)

所以让我们说，所以让我们说，说英语的，说英语的，客户服务代理出现，客户服务代理出现，说嘿，说嘿，客户保修不包括厨房清洁费用，客户保修不包括厨房清洁费用，因为是你误用搅拌机，用叉子戳盖子。

因为是你误用搅拌机，用叉子戳盖子，运气不好，运气不好，再见，不是很礼貌的信息，再见，不是很礼貌的信息，但假设这是客户服务代理想要的，但假设这是客户服务代理想要的。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_106.png)

我们将指定，我们将指定，服务消息将翻译成这种海盗风格，服务消息将翻译成这种海盗风格，我们希望它是用英语海盗语说的礼貌语调，我们希望它是用英语海盗语说的礼貌语调，因为我们之前创建了提示模板。

因为我们之前创建了提示模板。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_108.png)

酷的是，酷的是，我们现在可以重复使用那个提示模板，我们现在可以重复使用那个提示模板，并指定我们想要的服务风格海盗，并指定我们想要的服务风格海盗，文本是此服务回复，文本是此服务回复，如果我们这样做。

如果我们这样做。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_110.png)

这是提示，这是提示。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_112.png)

如果我们提示，如果我们提示，嗯，chagpt t，嗯，chagpt t。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_114.png)

这是它给我们的回应，这是它给我们的回应，我必须为你进来，保修不包括费用或清洁你的船舱等。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_116.png)

运气不好，法老，我的心，你可能想知道。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_118.png)

为什么使用提示模板而不是，你知道，只是一个f字符串，答案是，随着你构建复杂的应用程序，提示可以相当长和详细。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_120.png)

因此，提示模板是一个有用的抽象，帮助你重用好的提示。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_122.png)

当你能，嗯，这是一个相对较长的提示示例，为在线学习应用程序评分学生的提交。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_124.png)

像这样的问题可能相当长，你可以要求LM首先解决问题，然后以特定格式输出。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_126.png)

并将此包装在lang链中，使用提示使重用这样的提示更容易。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_128.png)

你稍后也会看到lang链为一些常见操作提供了提示，如摘要或问答，或连接到SQL数据库。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_130.png)

或连接到不同的API，因此，通过使用一些lang链内置的提示，你可以快速构建一个应用程序，而不需要um。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_132.png)

设计你自己的提示，lang cha的提示库的另一个方面是它也支持输出解析，我们稍后会讲到这一点，但当你使用一个LLM构建一个复杂的应用程序时，你经常指示LM以特定格式生成其输出，如使用特定关键字。

左侧的例子说明了如何使用一个LLM执行称为链式思维，推理，使用称为React的框架，但不用担心技术细节，但关键是思想是LM在想什么，因为给LM思考的空间，它往往能得出更准确的结论。

然后行动作为关键字来执行具体行动，然后观察显示它从该行动中学到了什么，等等，如果你有一个提示，指示LM使用这些特定关键字，思想，行动和观察，然后可以将这个提示与解析器耦合。

以提取出带有这些特定关键字标记的文本，因此，这共同提供了一个很好的抽象，来指定输入给LM，并让解析器正确解释，让我们回到一个输出解析器的例子。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_134.png)

在这个例子中，让我们看看如何让lm输出，并使用lang chain传递该输出。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_136.png)

运行我将使用的示例，将是从产品评论中提取信息。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_138.png)

并将该输出格式化为相邻格式。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_140.png)

这是您希望输出的技术示例，这是一个Python字典，其中产品是否为礼物，花费的天数，快递员是5人，价格相当实惠，这是一个期望输出的例子。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_142.png)

这是一个客户评价的例子。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_144.png)

以及尝试达到该JSON输出的模板，这是一个客户评价，睡眠模糊效果相当惊人，它有4个设置，蜡烛吹灭器，性别，微风，风城与龙卷风，两天后到达，及时为妻子周年礼物，我认为我妻子很喜欢，她至今无语。

我一直是唯一使用者等，以下为文本评论模板，从指定信息提取，这是动图吗，这种情况下是，因为这是个动图，还有送货日期，送达用了多久，看起来，这次两天就到了，价格多少，你知道，稍微贵点，鼓风机等。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_146.png)

因此，将评论模板作为输入的LM，客户评论，并提取这三个字段，然后格式化为输出，嗯，使用以下键。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_148.png)

好的，所以这是如何用lang chain包装的。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_150.png)

让我们导入聊天提示模板，我们之前已导入，技术上这行多余，但我会再导入，然后从评审模板创建提示模板。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_152.png)

这是提示模板。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_154.png)

类似我们之前使用提示模板，创建要传递给Open Eye的消息，嗯，端点，处理开放端点，调用该端点，然后打印响应，鼓励你暂停视频并运行代码。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_156.png)

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_157.png)

就是它，它说，如果为真，这是二，价格值看起来也很准确。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_159.png)

嗯，但请注意，如果我们检查。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_161.png)

响应的类型，这实际上是一个字符串，所以看起来像JSON，看起来像键值对，但实际上不是一个字典，这只是一个长字符串。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_163.png)

所以我想做的是去响应内容并获取。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_165.png)

如果键的值，应该是真，但运行这个，应该会报错，因为，嗯。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_167.png)

这实际上是一个字符串，这不是Python字典，所以让我们看看如何使用Lang Chains解析器。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_169.png)

为了做到这一点。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_171.png)

我将导入，响应模式和结构化输出解析器从Lang Chain，并告诉它我想要暂停。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_173.png)

通过指定这些响应模式。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_175.png)

所以礼物模式名为礼物，描述是购买的礼物送给别人。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_177.png)

回答真或是，假，如果不是，那么未知。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_179.png)

等等，所以有一个好的模式，交付模式价格值模式，然后将它们全部放入列表如下。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_181.png)

现在我已经指定了这些模式的启动，实际上可以给你提示本身，输出为正，告诉你指令，若打印格式指令，她有精确指令，生成可解析输出，这是新评论模板。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_183.png)

评论模板含格式指令。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_185.png)

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_186.png)

可从模板创建提示。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_188.png)

创建传递给OpenAI的消息。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_190.png)

若想，可查看实际提示，含提取熔断器指令，若送货天数，价格值，这是文本，然后这是格式指令，最后，若调用OpenAI端点，看看响应，现在这样。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_192.png)

若使用创建的输出解析器。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_194.png)

可传入输出字典。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_196.png)

区域打印看起来像这样。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_198.png)

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_199.png)

非字符串，可提取与礼物键关联的值，或与送货天数关联的值。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_201.png)

或提取与价格值关联的值。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_203.png)

这是将LM输出。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_205.png)

解析为Python字典。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_207.png)

使输出便于下游处理，建议暂停视频并运行代码，模型、提示和解析结束，希望你能重用提示模板，轻松分享，与合作者，甚至使用Lang Chains内置模板，如你刚见。



![](img/f5b781dc791e91ed41bc97e6c7e7e36f_209.png)

常与输出解析器结合，使输入提示到特定格式输出，然后解析器解析该输出，存储数据于Python字典。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_211.png)

或其他数据结构，便于下游处理。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_213.png)

希望这在你的应用中很有用。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_215.png)

就这样，让我们看下一个视频，Lang Chain如何帮你建更好的聊天机器人，或让LM，更有效地聊天。

![](img/f5b781dc791e91ed41bc97e6c7e7e36f_217.png)