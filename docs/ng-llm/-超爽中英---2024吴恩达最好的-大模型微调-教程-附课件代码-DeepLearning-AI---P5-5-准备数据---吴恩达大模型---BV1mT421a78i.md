# (超爽中英!) 2024吴恩达最好的【大模型微调】教程！附课件代码 DeepLearning.AI - P5：5-准备数据 - 吴恩达大模型 - BV1mT421a78i

![](img/f3f068b1d071ba200429dfe4484c2710_0.png)

在探索了本课将使用的数据之后，你将学习如何为训练准备数据，让我们跳进去吧，所以接下来你需要准备好什么样的数据，有一些好的最佳实践，所以一个是你想要更高质量的数据，实际上，这是你微调所需要的第一件事。

而不是低质量的数据，我说的是什么意思，那就是，如果你给它，你知道垃圾输入，它会鹦鹉学舌，给你垃圾输出，所以提供高质量的数据很重要，其次是多样性，因此，拥有涵盖用例许多方面的不同数据是有帮助的。

你所有的输入和输出都是一样的，然后模型就可以开始记忆它们了，如果这不是你想要的，然后模型就会开始一遍又一遍地喷出同样的东西，所以在你的数据中有多样性是非常重要的，下一个是真实的或生成的。

我知道有很多方法可以创建生成的数据，你已经看到了一种使用LLM的方法，但实际上拥有真实的数据是非常，大多数时候非常有效和有帮助，尤其是那些写作任务，这是因为生成的数据已经有了一定的模式。

您可能听说过一些试图检测，是否生成了某物，这实际上是因为有模式和生成的数据，他们试图检测，结果呢，如果你用更多相同的模式训练，它不一定会学习新的模式或构建事物的新方法，最后我把这个放在最后。

因为实际上在大多数机器学习应用程序中，拥有更多的数据比拥有更少的数据更重要，但正如你刚才看到的，预训练处理了很多这个问题，预训从大量数据中学到了，你都是从网上知道的，所以它已经有了很好的基础理解。

不是从零开始的，因此，拥有更多的数据有助于模型，但不如前三名重要。

![](img/f3f068b1d071ba200429dfe4484c2710_2.png)

而且绝对没有质量重要，所以首先，让我们来看看收集数据的一些步骤，你们已经看到了一些指令响应对，所以第一步是收集它们，下一个是把这些对连接起来，或添加提示模板，你也看到了，下一步是标记数据，添加填充。

或截断数据，所以放进模型里的尺寸是合适的，你会在实验室里看到如何标记它，因此，准备数据的步骤是收集这些指令响应对，也许那是问答对，然后它将这些对连接在一起，或者像以前一样添加一些提示模板。

第三步是标记数据，最后一步是将这些数据分成训练和测试。

![](img/f3f068b1d071ba200429dfe4484c2710_4.png)

在象征什么，那到底是什么意思，嗯，标记数据是将文本数据，实际上把它变成数字，代表每一段文本，实际上不一定是通过文字，它是基于你知道的常见字符出现的频率，所以在这种情况下，我的最爱之一是img令牌。

这在标记者中很常见，这是因为这发生在每一个乔恩身上，所以在这里你可以看到微调，我不去，所以JD中的每一个动词，你知道微调或标记都有IMG，这映射到这里的代币278，当你用同样的标记器解码它时。

它又变成了同样的文本，现在有很多不同的标记器，标记器实际上与每个模型的特定模型相关联，因为它被训练在上面，如果你给你的模型错误的标记器，它会很困惑，因为它希望不同的数字代表不同的字母和单词。

所以确保你使用了正确的标记器，你会在实验室里看到如何轻松地做到这一点--很酷。

![](img/f3f068b1d071ba200429dfe4484c2710_6.png)

所以让我们去看笔记本，好啦，因此，首先我们将导入几个不同的库，实际上，这里最重要的一个是自动标记器类，从变形金刚图书馆通过拥抱脸。



![](img/f3f068b1d071ba200429dfe4484c2710_8.png)

它的作用是惊人的，它会自动为您的模型找到正确的标记器，当您只指定模型是什么时，所以你所要做的就是给模型起一个名字，这和你以前看到的型号名字一样，价值七千万的巨蟒模型，好啦，所以也许你有一些短信说。

你知道嗨，你现在怎么样，让我们把那篇文章标记一下，所以把它放在嘣里，所以让我们看看什么编码文本是好的，所以这里有不同的数字表示文本，标记器输出一个带有表示标记的输入ID的字典，所以我只是打印在这里。

然后让我们把它编码回文本中。

![](img/f3f068b1d071ba200429dfe4484c2710_10.png)

看看它是否真的会变成嗨，你好吗酷毙了。

![](img/f3f068b1d071ba200429dfe4484c2710_12.png)

它又变成了嗨，你怎么这么，那太好了，好啦，所以呃，在标记时，您可能会放入成批的输入。

![](img/f3f068b1d071ba200429dfe4484c2710_14.png)

所以让我们一起看看几个不同的输入。

![](img/f3f068b1d071ba200429dfe4484c2710_16.png)

所以有嗨，你好吗，我很好，是的，所以把文本列表，你可以像这样把它分批放进代币机里，你在这里得到了一些不同的东西，所以我是这样做的，你好吗？我又好又小，而且是的，只是一个信物。

所以你可以看到这些在长度上是不同的，实际上这对模特来说很重要，批次中的所有东西都是相同的长度，因为你用的是固定尺寸的张量，所以文本需要相同，所以我们做的一件事叫做填充填充。

是为我们的填充令牌处理这些可变长度编码文本的策略，你必须指定，你知道你想要什么，要表示填充的数字是多少，特别是我们用的是零，它实际上也是句子的结尾标记。

所以当我们通过标记器运行padding equals true时，你可以看到是，字符串右边有很多0，只是为了配合这个高的长度，你怎么串，您的模型也将有一个最大的长度，它可以处理和接受。

所以它不能把所有的东西都放进去，你以前玩过提示，您可能已经注意到提示符的长度是有限制的，所以这是一回事，截断是一种处理策略，使那些编码文本更短，这实际上符合模型。



![](img/f3f068b1d071ba200429dfe4484c2710_18.png)

所以这是让它变短的一种方法，所以你可以在这里看到，我只是人为地将最大长度改为三个，将截断设置为true。



![](img/f3f068b1d071ba200429dfe4484c2710_20.png)

然后看到现在对嗨来说短多了，你好吗，它是从右边截断的，所以现在只是把这里的一切都处理掉，实际上，有一件事很常见，你知道你在写一个提示，也许你在某个地方有你的指示，你有很多重要的事情，也许在另一边。

在右边在右边。

![](img/f3f068b1d071ba200429dfe4484c2710_22.png)

它被截断了，所以你知道，指定向左的截断边。

![](img/f3f068b1d071ba200429dfe4484c2710_24.png)

实际上可以用另一种方式截断它，所以这真的取决于你的任务，然后呢，实际用于填充和截断。

![](img/f3f068b1d071ba200429dfe4484c2710_26.png)

您想同时使用，所以让我们把两个都放在那里，所以这里截断为真，填充为真。

![](img/f3f068b1d071ba200429dfe4484c2710_28.png)

把它打印出来，所以你可以看到这里的零，但也被截断为三个伟大的，所以这真的是一个玩具例子，我现在要粘贴一些您在前一个实验室中完成的代码。



![](img/f3f068b1d071ba200429dfe4484c2710_30.png)

即时，所以在这里，它加载了带有问题和答案的数据集文件。

![](img/f3f068b1d071ba200429dfe4484c2710_32.png)

把它放进提示符里，一气呵成。

![](img/f3f068b1d071ba200429dfe4484c2710_34.png)

现在你可以在这里看到一个问答的数据点。

![](img/f3f068b1d071ba200429dfe4484c2710_36.png)

所以现在您可以在这些数据点中的一个上运行这个标记器，所以首先把这个问题和那个答案联系起来，再通过标记器，我只是在这里以麻木的形式返回张量。



![](img/f3f068b1d071ba200429dfe4484c2710_38.png)

简单地说，运行它只需填充，那是因为我不知道这些代币实际上会有多长时间，所以重要的是。

![](img/f3f068b1d071ba200429dfe4484c2710_40.png)

然后我想出了，您知道最大长度和标记输入之间的最小值。

![](img/f3f068b1d071ba200429dfe4484c2710_42.png)

当然，你总是可以垫到最长的，你总是可以垫到最大长度，所以这就是这里的东西，嗯，然后我再次标记截断到最大长度，我把它打印出来。



![](img/f3f068b1d071ba200429dfe4484c2710_44.png)

![](img/f3f068b1d071ba200429dfe4484c2710_45.png)

从字典里指定就行了，这就是代币的样子，所以让我们把它包装成一个完整的函数。

![](img/f3f068b1d071ba200429dfe4484c2710_47.png)

所以你可以在你的整个数据集中运行它，所以这又是，同样的事情发生在这里，你已经看到了抓住最大长度。

![](img/f3f068b1d071ba200429dfe4484c2710_49.png)

设置截断侧，这是一个标记数据集的函数，现在你能做的就是。

![](img/f3f068b1d071ba200429dfe4484c2710_51.png)

您可以加载该数据集，这里有一个很好的地图功能，因此，您可以将标记化函数映射到该数据集，你会看到这里，我在做一件很简单的事，所以我把批量设置为1，很简单，它将被分批，并下降最后一批真。



![](img/f3f068b1d071ba200429dfe4484c2710_53.png)

你知道我们经常这样做，以帮助混合大小的输入，所以最后一批可能是不同大小的。

![](img/f3f068b1d071ba200429dfe4484c2710_55.png)

很好下一步是拆分数据集。

![](img/f3f068b1d071ba200429dfe4484c2710_57.png)

所以首先我必须在这个标签列中添加，至于抱脸处理，然后我要运行这个火车测试分裂函数，我将把测试大小指定为数据的10%，所以你当然可以改变这个，根据您的数据集有多大，洗牌是真的。

所以我把这个数据集的顺序随机化，它就会把它打印出来。

![](img/f3f068b1d071ba200429dfe4484c2710_59.png)

所以现在您可以看到数据集已经被拆分了，训练和测试在一百四十为测试设置在那里，当然，这个已经装满了，拥抱脸，就像你以前看到的，所以你可以去那里下载它，看看它是一样的。



![](img/f3f068b1d071ba200429dfe4484c2710_61.png)

所以虽然这是一个专业的数据集，是关于一家公司的，也许这和你的公司有关，例如，您可以使其适应您的公司，我们觉得那可能有点无聊，不一定是，因此，我们包括了一些更有趣的数据集，您也可以使用这些数据集。

并随时为这些定制和训练您的模型，一个是给泰勒斯威夫特的，一个是给流行乐队bts的，一个是开源的大型语言模型，你可以玩。



![](img/f3f068b1d071ba200429dfe4484c2710_63.png)

只是看着，你知道的，来自Tay Tay数据集的一个数据点。

![](img/f3f068b1d071ba200429dfe4484c2710_65.png)

我们去看看好的，泰勒·斯威夫特在千禧一代中最受欢迎的歌曲是什么，一首歌与千禧一代有何关联，好啦，好啦，所以你可以自己看看，嗯是的，这些数据集可通过拥抱脸获得，现在在下一个实验室。

既然你已经准备好了所有的数据。