#  DeepLearning.AI - P14：6——问答聊天机器人 - 吴恩达大模型 - BV1iZ421M79T

![](img/e1413a46a066fb0fe58e11f740158ac6_0.png)

我们已经讨论了如何检索与给定问题相关的文档，下一步就是把那些文件，接受最初的问题，把它们都传递给一个语言模型，并要求它回答这个问题，我们将在这节课中复习这一点，完成这项任务的几种不同方法。

让我们开始上这节课吧。

![](img/e1413a46a066fb0fe58e11f740158ac6_2.png)

我们将讨论如何做问题，使用您刚刚检索到的文档进行应答，这是在我们完成整个储存和摄入之后，在我们检索到相关的分裂后，现在我们需要把它传递给一个语言模型来得到答案。



![](img/e1413a46a066fb0fe58e11f740158ac6_4.png)

一般的流程是这样的，问题来了。

![](img/e1413a46a066fb0fe58e11f740158ac6_6.png)

我们查阅相关文件，然后我们通过这些分裂，伴随着系统提示符。

![](img/e1413a46a066fb0fe58e11f740158ac6_8.png)

和人类的问题到语言模型并得到答案，默认情况下，我们只需将所有块传递到同一个上下文窗口中，语言模型的相同调用。



![](img/e1413a46a066fb0fe58e11f740158ac6_10.png)

然而，我们可以使用一些不同的方法，对此有利弊。

![](img/e1413a46a066fb0fe58e11f740158ac6_12.png)

大多数优点来自于这样一个事实，即有时会有很多文件，您不能简单地将它们都传递到相同的上下文菜单中。

![](img/e1413a46a066fb0fe58e11f740158ac6_14.png)

Mapreduce，精炼。

![](img/e1413a46a066fb0fe58e11f740158ac6_16.png)

我们将在今天的课上讨论其中的一些，让我们开始编码。

![](img/e1413a46a066fb0fe58e11f740158ac6_18.png)

第一批，我们会像往常一样输入环境变量。

![](img/e1413a46a066fb0fe58e11f740158ac6_20.png)

然后，我们将加载以前持久化的向量数据库，我要检查它是否正确。

![](img/e1413a46a066fb0fe58e11f740158ac6_22.png)

我们可以看到它有以前的209份文件。

![](img/e1413a46a066fb0fe58e11f740158ac6_24.png)

我们做一个快速的相似性搜索，为了确保它对第一个问题起作用，即这门课的主要主题是什么。

![](img/e1413a46a066fb0fe58e11f740158ac6_26.png)

现在我们初始化我们要用来回答问题的语言模型。

![](img/e1413a46a066fb0fe58e11f740158ac6_28.png)

我们将使用聊天开放人工智能模型GPT三点五。

![](img/e1413a46a066fb0fe58e11f740158ac6_30.png)

我们要把温度设为零，当我们想要真实的答案出来时，这真的很好。

![](img/e1413a46a066fb0fe58e11f740158ac6_32.png)

因为它的可变性很低，通常只给我们最高的保真度，最可靠的答案。

![](img/e1413a46a066fb0fe58e11f740158ac6_34.png)

然后我们将导入检索QA链，这是在回答问题，由检索步骤支持。

![](img/e1413a46a066fb0fe58e11f740158ac6_36.png)

我们可以通过传入一个语言模型来创建它。

![](img/e1413a46a066fb0fe58e11f740158ac6_38.png)

然后向量数据库作为检索器。

![](img/e1413a46a066fb0fe58e11f740158ac6_40.png)

然后，我们可以调用它，查询等于我们想要问的问题。

![](img/e1413a46a066fb0fe58e11f740158ac6_42.png)

当我们看到结果时，我们得到了答案，这堂课的主要主题是机器学习，另外，这门课可以在讨论部分复习统计学和代数。



![](img/e1413a46a066fb0fe58e11f740158ac6_44.png)

本季度晚些时候，讨论部分还将涵盖主要讲座中教授的材料的扩展。

![](img/e1413a46a066fb0fe58e11f740158ac6_46.png)

让我们试着更好地理解一点，引擎盖下面是怎么回事，并暴露一些不同的旋钮，你可以把主要部分，这里很重要的是我们正在使用的提示符，这是接收文档和问题并将其传递给语言模型的提示符。



![](img/e1413a46a066fb0fe58e11f740158ac6_48.png)

关于提示的复习。

![](img/e1413a46a066fb0fe58e11f740158ac6_50.png)

你可以看到我和安德鲁一起上的第一堂课，这里我们定义一个提示模板。

![](img/e1413a46a066fb0fe58e11f740158ac6_52.png)

它有一些关于如何使用以下上下文的说明，然后它有一个上下文变量的占位符，这就是文件要去的地方，以及问题变量的占位符。



![](img/e1413a46a066fb0fe58e11f740158ac6_54.png)

我们现在可以创建一个新的检索，Qn，我们将使用与以前相同的语言模型，在与以前相同的矢量数据库中，但我们将通过几个新的论点，所以我们得到了返回源文件，所以我们要把这个等于零设为真。

这将使我们能够轻松地检查我们检索的文档。

![](img/e1413a46a066fb0fe58e11f740158ac6_56.png)

然后我们还将传递一个提示。

![](img/e1413a46a066fb0fe58e11f740158ac6_58.png)

相当于QA链，我们在上面定义的提示，让我们尝试一个新问题：概率，课堂主题。

![](img/e1413a46a066fb0fe58e11f740158ac6_60.png)

我们得到一个结果，如果我们检查里面的东西，我们可以看到是的，概率被假定为该类的先决条件。

![](img/e1413a46a066fb0fe58e11f740158ac6_62.png)

讲师假设熟悉基本的概率统计，我们将在讨论部分讨论一些先决条件，作为复习课程，谢谢你的询问，当它回应我们时，它也很好，为了更好地了解它从哪里获得这些数据。



![](img/e1413a46a066fb0fe58e11f740158ac6_64.png)

我们可以看看一些被退回的源文件。

![](img/e1413a46a066fb0fe58e11f740158ac6_66.png)

如果你看穿它们，您应该看到，回答的所有信息都在这些源文档中的一个中，现在是停下来考虑几个不同问题的好时机，或者您自己的不同提示模板，看看到目前为止结果是如何变化的。



![](img/e1413a46a066fb0fe58e11f740158ac6_68.png)

我们一直在用东西技术，我们默认使用的技术，它基本上只是把所有的文档塞进最后的提示符中，这真的很好，因为它只涉及到对语言模型的一次调用，然而，这确实有一个限制，如果文件太多。



![](img/e1413a46a066fb0fe58e11f740158ac6_70.png)

它们可能并不都适合上下文窗口，一种不同类型的技术，我们可以用来做问题，回答文档是这种技术中的mapreduce技术，每个单独的文档首先被单独发送到语言模型以获得原始答案。



![](img/e1413a46a066fb0fe58e11f740158ac6_72.png)

然后这些答案被组成一个最终的答案，最后调用一个语言模型。

![](img/e1413a46a066fb0fe58e11f740158ac6_74.png)

这涉及到更多的语言模型调用，但它确实有优点，因为它可以对任意多的文档进行操作。

![](img/e1413a46a066fb0fe58e11f740158ac6_76.png)

当我们通过这个链运行前一个问题时，我们可以看到这种方法的另一个局限性，或者实际上我们可以看到两个一，慢多了，两个，结果其实更糟，这个问题没有明确的答案，根据文件的给定部分，可能会发生这种情况。

因为它是根据每个文档单独回答的。

![](img/e1413a46a066fb0fe58e11f740158ac6_78.png)

因此，如果有信息分散在两个文档中，它并没有把所有的东西都放在同一个背景下。

![](img/e1413a46a066fb0fe58e11f740158ac6_80.png)

这是利用车道链平台获得感提升的好机会，因为这些锁链里面发生了什么。

![](img/e1413a46a066fb0fe58e11f740158ac6_82.png)

我们将在这里演示这一点，如果你想自己用的话。

![](img/e1413a46a066fb0fe58e11f740158ac6_84.png)

教材里会有说明，关于如何获得API密钥，一旦我们设置了这些环境变量，我们可以重新运行地图，减少链条，然后我们可以切换到用户界面，看看发生了什么。



![](img/e1413a46a066fb0fe58e11f740158ac6_86.png)

在引擎盖下，从这里我们可以找到我们刚才运行的运行。

![](img/e1413a46a066fb0fe58e11f740158ac6_88.png)

我们可以点击它，我们可以看到输入和输出，然后我们可以看到孩子跑去很好地分析发生了什么，在引擎盖下，第一批，我们有MapReduce文档链，这实际上涉及到对语言模型的四个单独调用。



![](img/e1413a46a066fb0fe58e11f740158ac6_90.png)

如果我们点击其中一个电话，我们可以看到我们有每个文档的输入和输出。

![](img/e1413a46a066fb0fe58e11f740158ac6_92.png)

如果我们回去，然后我们可以看到，在它运行这些文档之后，它在最后的链条中结合在一起，填充文档链，它将所有这些响应塞进最后的呼叫中，点击进入。



![](img/e1413a46a066fb0fe58e11f740158ac6_94.png)

我们可以看到我们得到了系统消息，我们从以前的文件中得到了四个摘要，然后用你的问题，然后我们就有了答案，我们可以做类似的事情，将链类型设置为细化。



![](img/e1413a46a066fb0fe58e11f740158ac6_96.png)

这是一种新型的链条，让我们看看引擎盖下面是什么样子，我们可以看到它正在调用精炼文档链，包括4次连续呼叫，让我们来看看这个链中的第一个调用，来看看这里发生了什么，在它被发送到语言模型之前。

我们已经得到了提示，我们可以看到一个由几个比特组成的系统消息，这篇文章的上下文信息如下，是系统消息的一部分，它是我们提前定义的提示模板的一部分，下一段，这里的所有文字，这是我们检索到的文件之一。

下面是用户的问题，答案就在这里，如果我们回去，我们可以在这里查看对语言模型的下一个调用，我们发送给语言模型的最后一个提示，是将以前的响应与新数据相结合的序列，然后要求改进回应。

所以我们可以在这里看到我们得到了最初的用户问题。

![](img/e1413a46a066fb0fe58e11f740158ac6_98.png)

我们就得到了答案，这是和以前一样的，然后我们说我们只有机会改进现有的答案，如果需要，请在下面提供更多上下文，这是提示模板的一部分，部分说明，剩下的部分是我们检索列表中第二个文档的文档，然后我们可以看到。

在新的上下文中，我们有更多的指示，改进原始答案以更好地回答问题，然后在下面我们得到了最终的答案，但这只是第二个最终答案，所以它运行了四次，在得到最终答案之前，它会遍历所有的文档，最终的答案就在这里。

这门课假定熟悉基本的概率和统计学，但是我们会有复习部分来刷新先决条件，您会注意到这是一个比地图缩减链更好的结果，这是因为使用细化链确实允许您组合信息，尽管按顺序。

它实际上鼓励了比mapreduce链更多的信息传递，这是一个暂停的好机会，尝试一些问题，尝试一些不同的链条，尝试一些不同的提示模板，看看它在UI中是什么样子的，这里有很多东西可以玩。

聊天机器人的伟大之处之一，为什么它们变得如此受欢迎是因为你可以问后续的问题。

![](img/e1413a46a066fb0fe58e11f740158ac6_100.png)

你可以要求澄清以前的答案，所以让我们在这里做，让我们创建一个QA链，我们就用默认的东西。

![](img/e1413a46a066fb0fe58e11f740158ac6_102.png)

我们去问问吧，一个问题是概率，课堂主题。

![](img/e1413a46a066fb0fe58e11f740158ac6_104.png)

然后让我们问它一个后续问题，它提到概率应该是一个先决条件，所以让我们问，为什么需要这些先决条件，然后我们得到答案。



![](img/e1413a46a066fb0fe58e11f740158ac6_106.png)

这门课的先决条件假定是计算机科学的基础知识。

![](img/e1413a46a066fb0fe58e11f740158ac6_108.png)

以及与之前答案完全无关的基本计算机技能和原理，我们在问概率，这是怎么回事，基本上，我们使用的链没有任何状态的概念，它不记得以前的问题或以前的答案是什么，为此我们需要引入记忆。



![](img/e1413a46a066fb0fe58e11f740158ac6_110.png)