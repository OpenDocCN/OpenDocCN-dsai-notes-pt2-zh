# (超爽中英!) 2024吴恩达最好的【大模型微调】教程！附课件代码 DeepLearning.AI - P7：7-评估和迭代 - 吴恩达大模型 - BV1mT421a78i

![](img/313ea25cd482ecc0b7f61a44d30f776b_0.png)

既然你训练完了你的模特，下一步是评估，看看它怎么样了，这是非常重要的一步，因为人工智能就是迭代，这有助于您随着时间的推移改进模型，好啦，让我们开始吧，评估生成模型是出了名的非常，非常困难。

你没有明确的衡量标准，随着时间的推移，这些模型的性能有了很大的提高，度量实际上很难跟上，所以结果，人的评价往往是最可靠的方式，所以这实际上是让了解该领域的专家评估输出，一个好的测试数据集。

这对于很好地利用那个人的时间是极其重要的，这意味着这是一个高质量的数据集，很准确，所以你已经检查过了，以确保它是准确的，是广义的，所以它实际上涵盖了很多不同的测试用例，你要确保模型覆盖，当然。

在训练数据中看不到，另一种流行的方法是elo比较，所以这看起来几乎像是多个模型之间的B测试，或跨多个型号的锦标赛，ELO排名专门用于国际象棋，因此，这也是能够理解哪些模型性能良好的一种方法，或者不是。

因此，一个真正常见的开放LLM基准测试是一套不同的评估方法。

![](img/313ea25cd482ecc0b7f61a44d30f776b_2.png)

所以它实际上采取了一系列不同的可能的评估方法，把它们平均起来给模型排名，这个是路德艾发明的，这是一组不同的基准放在一起，所以一个是弧形，这是一套小学的问题，海拉·斯瓦格是对常识的考验。

MLU涵盖了很多小学科目，和真实的质量保证措施，该模型再现你通常可以在网上找到的谎言的能力，所以这些是一组基准，是研究人员随着时间的推移开发出来的，现在已经在这个公共评估套件中使用了，你可以看到这里。

这是最新的排名，在这段录音中，但我相信这种情况一直在变化，美洲驼二号做得很好，这实际上不一定是按这里的平均值排序的，美洲驼二号做得很好，最近有一个免费的威利模型很好，在美洲驼顶上调谐模特。

我在用虎鲸的方法，这就是为什么它被称为自由威利，我不打算说太多，这里有很多动物在活动。

![](img/313ea25cd482ecc0b7f61a44d30f776b_4.png)

不过，你可以自己去看看，好啦，因此，分析和评估模型的另一个框架称为误差分析，这就是对错误进行分类，好让你明白，你知道非常常见的错误类型，并在非常常见的错误之后，首先是灾难性的错误，这真的很酷。

因为我们的分析通常要求你先训练你的模型，但当然有一个微调，你已经有了一个经过预先训练的基础模型，因此，在微调模型之前，您已经可以执行错误分析，这有助于您理解和描述基本模型的工作方式。



![](img/313ea25cd482ecc0b7f61a44d30f776b_6.png)

这样你就知道什么样的数据会给它最大的提升来微调，所以有很多不同的类别，我将介绍几个常见的，你可以看看，所以一个只是拼写错误，这很简单，很简单，所以这里说，去检查一下你的肝脏或杠杆。



![](img/313ea25cd482ecc0b7f61a44d30f776b_8.png)

而且拼错了，因此，在数据集中修复这个示例是很重要的。

![](img/313ea25cd482ecc0b7f61a44d30f776b_10.png)

只是拼写正确，长度是我听说的一个很常见的，你知道的，聊天，一般的GPT或生成模型，他们真的很啰嗦，所以一个例子是确保你的数据集不那么冗长，所以它实际上是在非常简洁地回答这个问题，你已经看过了。

我们可以做一点的训练笔记本，在模型中，不那么冗长，也不那么重复，说到重复，嗯，你知道的，这些模型确实倾向于非常重复，所以一种方法是用，任一停止令牌更显式，您看到的那些提示模板，但是，当然啦。

还要确保你的数据集包括没有太多重复的例子，有多样性很酷，所以现在进入一个实验室，在那里你可以在测试数据集上运行模型，然后能够运行几个不同的度量，但大部分是手工检查的，也运行在一个LLM基准上。

你看到弧线。

![](img/313ea25cd482ecc0b7f61a44d30f776b_12.png)

好啦，所以这实际上可以在一行代码中完成，它以批处理的方式在整个测试数据集上运行您的模型，这在gpus上是非常有效的，所以我只想在这里分享，你可以在这里加载你的模型，实例化。

然后让它在整个测试数据集的列表上运行，然后它很快就会自动批处理到Gpus上。

![](img/313ea25cd482ecc0b7f61a44d30f776b_14.png)

现在我们基本上是在CPU上运行的，所以在这个实验室里，你实际上可以。

![](img/313ea25cd482ecc0b7f61a44d30f776b_16.png)

只需在几个测试数据点上运行它，当然你自己也可以做得更多，好的很好，所以我认为第一件事是加载测试数据集，我们一直在研究的，然后让我们来看看其中一个数据点是什么样子的。



![](img/313ea25cd482ecc0b7f61a44d30f776b_18.png)

所以要打印问题答案对。

![](img/313ea25cd482ecc0b7f61a44d30f776b_20.png)

好啦，这是我们一直在研究的一个，然后我们要加载模型，在整个数据集中运行它。

![](img/313ea25cd482ecc0b7f61a44d30f776b_22.png)

所以这和以前一样。

![](img/313ea25cd482ecc0b7f61a44d30f776b_24.png)

我要把真正的微调模型从拥抱脸中拿出来，好啦，所以现在我们已经加载了我们的模型，我将列出一个非常基本的评估指标。



![](img/313ea25cd482ecc0b7f61a44d30f776b_26.png)

只是为了让你了解这个生成任务，它将是两个字符串之间的精确匹配，当然啦，去掉一点空白，但只是想知道它是否能完全匹配，这对那些写作任务来说真的很难，因为它在生成内容，实际上有很多不同的可能的正确答案。

所以它不是一个超级有效的评估指标，你知道的，阅读引用未引用的任务，那些阅读任务，你可能会提取主题，你可能在提取一些信息，所以也许在那些更接近分类的情况下，这可能更有意义，但我只想把这个。

您还可以运行不同的评估指标，当您在评估模式下运行模型时，一个重要的事情是执行模型eval。

![](img/313ea25cd482ecc0b7f61a44d30f776b_28.png)

以确保像辍学这样的事情被禁用。

![](img/313ea25cd482ecc0b7f61a44d30f776b_30.png)

然后就像以前的实验室一样。

![](img/313ea25cd482ecc0b7f61a44d30f776b_32.png)

您可以运行此推断函数以生成输出。

![](img/313ea25cd482ecc0b7f61a44d30f776b_34.png)

让我们再次运行第一个测试题。

![](img/313ea25cd482ecc0b7f61a44d30f776b_36.png)

你得到输出，看看实际的答案，与之相比，它是相似的，但它并不完全在那里，所以当然当你运行完全匹配，它并不完美，这并不是说，没有其他方法来测量这些模型。



![](img/313ea25cd482ecc0b7f61a44d30f776b_38.png)

这是一个非常非常简单的方法，有时人们也会把这些输出放进另一个，我要问问它，给它打分，看看你有多清楚它有多接近，真的吗，您还可以使用嵌入。



![](img/313ea25cd482ecc0b7f61a44d30f776b_40.png)

所以你可以嵌入实际的答案，并实际嵌入生成的答案，看看他们在距离上有多近，所以有很多不同的方法你可以采取很酷的方法，所以现在要在整个数据集中运行这个，这就是可能的样子，所以，让我们实际上运行它超过10。



![](img/313ea25cd482ecc0b7f61a44d30f776b_42.png)

因为这需要相当多的时间，所以您继续迭代该数据集。

![](img/313ea25cd482ecc0b7f61a44d30f776b_44.png)

在这里拉出问题的答案，我也在试图把预测器的答案。

![](img/313ea25cd482ecc0b7f61a44d30f776b_46.png)

把它和其他答案，这样你以后就可以手动检查了。

![](img/313ea25cd482ecc0b7f61a44d30f776b_48.png)

然后看看精确匹配的数量，在这里评估，所以精确匹配的数目为零，这其实并不令人惊讶，因为这是一个非常有创造性的任务，对于这些任务来说，你知道的，同样，有很多不同的方法来评估，但归根结底。



![](img/313ea25cd482ecc0b7f61a44d30f776b_50.png)

什么被发现更有效，很大程度上是在一个非常精心策划的测试集上使用人工检查。

![](img/313ea25cd482ecc0b7f61a44d30f776b_52.png)

这就是数据帧的样子，所以现在你可以去看看，好啦，对于每一个预测的答案，目标是什么，有多近真的很好很酷。



![](img/313ea25cd482ecc0b7f61a44d30f776b_54.png)

所以这只是数据的一个子集，我们也根据这里的所有数据进行了评估。

![](img/313ea25cd482ecc0b7f61a44d30f776b_56.png)

你可以从拥抱的脸开始，你知道的，基本上手动查看和评估所有数据。

![](img/313ea25cd482ecc0b7f61a44d30f776b_58.png)

![](img/313ea25cd482ecc0b7f61a44d30f776b_59.png)

最后但并非最不重要的嗯，你会看到跑步弧线，这是一个基准，所以如果你好奇，你知道学术基准，这是您刚刚在不同的LLM基准测试套件中探索的一个，这个弧形基准作为提醒是你知道的，这四个是我想出来的。

并把它们放在一起，这些来自学术论文，然后这个呢，如果检查数据集，你会发现你知道的科学问题，可能与您的任务有关，也可能与您的任务无关。



![](img/313ea25cd482ecc0b7f61a44d30f776b_61.png)

而这些评估指标，尤其是在这里，对学术竞赛或理解非常好，你知道的，一般模型能力，有时在这些，在这种情况下，小学基本问题，但我真的建议你知道。



![](img/313ea25cd482ecc0b7f61a44d30f776b_63.png)

即使你运行这些，也不一定太关注性能。

![](img/313ea25cd482ecc0b7f61a44d30f776b_65.png)

在这些基准上，尽管现在人们是这样给模特排名的，那是因为它们与。

![](img/313ea25cd482ecc0b7f61a44d30f776b_67.png)

您的用例不一定与您的公司关心的内容相关，你真正关心的是什么，为了你的结局，微调模型的用例。

![](img/313ea25cd482ecc0b7f61a44d30f776b_69.png)

正如你可能看到的，微调模型能够，基本上是为大量不同的任务量身定做，这需要大量不同的方法来评估它们。

![](img/313ea25cd482ecc0b7f61a44d30f776b_71.png)

好啦，弧线基准刚刚运行完毕，分数就在这里，第三点一，实际上这比论文中基本模型的分数要低，也就是36点，太疯狂了，因为你看到它在这个上有了很大的进步，但这是因为它给公司带来了很大的进步。

与本公司有关的数据集，与问题有关，为它回答，不是小学科学对吧，所以这就是弧线真正测量的，当然啦，如果你在一般任务上微调一个模型，所以如果你在羊驼身上微调，例如，对于这个特定的基准测试。

您应该会看到性能上的一点提升，如果你用一个更大的模型，你也会看到一个可能的肿块，因为它学到了更多，嗯，基本上就是这样，所以正如你所看到的，这个弧形基准，可能只有当你在看一般模型和比较一般模型时才重要。

也许那是为你找到一个基础模型，但不是为了你真正的微调任务，不是很有用，除非你在微调模型来做小学的科学问题，好吧，上一课的笔记本就这样结束了，你将学到一些微调的实用技巧。



![](img/313ea25cd482ecc0b7f61a44d30f776b_73.png)