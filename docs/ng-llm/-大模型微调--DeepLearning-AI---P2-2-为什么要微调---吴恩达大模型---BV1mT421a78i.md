# 【大模型微调】 DeepLearning.AI - P2：2-为什么要微调 - 吴恩达大模型 - BV1mT421a78i

在这节课中，你将学习为什么你应该微调，微调到底是什么，将其与即时工程进行比较，去实验室，你可以比较一个微调模型和一个非微调模型，酷，我们开始吧好的，所以你为什么要在我们跳入。



![](img/1c71155de356fd211c1d20b0eabdb6d7_1.png)

为什么，让我们来谈谈微调到底是什么。

![](img/1c71155de356fd211c1d20b0eabdb6d7_3.png)

所以微调是把这些通用模型，比如GPT 3，把它们专门化到聊天CBD之类的东西上。

![](img/1c71155de356fd211c1d20b0eabdb6d7_5.png)

使其良好聊天的特定聊天用例，或者使用gpt 4把它变成一个专门的github。

![](img/1c71155de356fd211c1d20b0eabdb6d7_7.png)

副驾驶用例自动完成代码，初级保健医生就像你的通用模型，你每年都去你的CPP做一次全面检查，但一个微调或专门的模型就像心脏病专家或皮肤科医生。



![](img/1c71155de356fd211c1d20b0eabdb6d7_9.png)

有特殊专长的医生，实际上可以更深入地治疗你的心脏问题或皮肤问题。

![](img/1c71155de356fd211c1d20b0eabdb6d7_11.png)

那么微调实际上对您的模型有什么作用。

![](img/1c71155de356fd211c1d20b0eabdb6d7_13.png)

它使你有可能给它更多的数据。

![](img/1c71155de356fd211c1d20b0eabdb6d7_15.png)

比符合提示符的东西，这样你的模型就可以从数据中学习。

![](img/1c71155de356fd211c1d20b0eabdb6d7_17.png)

而不仅仅是获得它，从这个学习过程中，它能够从PCP升级到更专业的东西。

![](img/1c71155de356fd211c1d20b0eabdb6d7_19.png)

就像皮肤科医生，所以你可以在这个图中看到，你可能会有一些症状输入到模型中，像皮肤刺激。

![](img/1c71155de356fd211c1d20b0eabdb6d7_21.png)

红肿，瘙痒，而基础模型，哪款是通用的，可能会说这可能是痤疮，根据皮肤病学数据微调的模型。

![](img/1c71155de356fd211c1d20b0eabdb6d7_23.png)

但是，可能会有同样的症状，并能给你一个更清楚的。

![](img/1c71155de356fd211c1d20b0eabdb6d7_25.png)

更具体的诊断，除了学习新信息，微调还可以帮助引导模型获得更一致的输出，或更一致的行为。

![](img/1c71155de356fd211c1d20b0eabdb6d7_27.png)

例如，当你问它的时候，你可以在这里看到基础模型，你的名字是什么？它可能会回答你姓什么，因为它看到了太多关于不同问题的调查数据。



![](img/1c71155de356fd211c1d20b0eabdb6d7_29.png)

所以它甚至不知道它应该回答这个问题，但是一个微调的模型，相比之下，当你问的时候，你能清楚地回答你的名字吗？



![](img/1c71155de356fd211c1d20b0eabdb6d7_31.png)

我叫莎伦，这个机器人可能是在我身上训练的，除了引导模型获得更一致的输出或行为之外。

![](img/1c71155de356fd211c1d20b0eabdb6d7_33.png)

微调可以帮助模型减少幻觉，这是一个常见的问题，模型编造东西。

![](img/1c71155de356fd211c1d20b0eabdb6d7_35.png)

也许它会说我的名字是鲍勃，当这是在我的数据上训练的时候。

![](img/1c71155de356fd211c1d20b0eabdb6d7_37.png)

我的名字绝对不是鲍勃，微调使您能够根据特定的用例定制模型。

![](img/1c71155de356fd211c1d20b0eabdb6d7_39.png)

在微调过程中，我们稍后会更详细地讨论，它实际上与模型早期的训练食谱非常相似。

![](img/1c71155de356fd211c1d20b0eabdb6d7_41.png)

所以现在把它和你可能更熟悉的东西进行比较。

![](img/1c71155de356fd211c1d20b0eabdb6d7_43.png)

快速工程，这是您在大型语言模型中已经做了一段时间的事情，但也许在过去的十年里，谷歌，它只是在编辑查询时放置一个查询，更改您看到的结果，所以有很多好处来提示，一个是你真的不需要任何数据就可以开始。

你可以开始和模特聊天，有一个较小的前期成本，所以你真的不需要考虑成本。

![](img/1c71155de356fd211c1d20b0eabdb6d7_45.png)

因为每次你呼叫模型，没那么贵，你并不真的需要技术知识来开始，你只需要知道如何发短信。

![](img/1c71155de356fd211c1d20b0eabdb6d7_47.png)

很酷的是，现在有一些方法可以使用，比如检索，增强型发电，或抹布将更多数据连接到它，有选择地选择现在进入提示符的数据类型，当然如果你有更多的数据，那么它可能不适合提示符，所以你不能用那么多数据，通常。

当你试图适应大量的数据时，不幸的是，它会忘记很多数据，幻觉有问题，当模特编造东西的时候，很难纠正那些不正确的信息。



![](img/1c71155de356fd211c1d20b0eabdb6d7_49.png)

它已经学会了，当使用检索时，增强生成可以很好地连接您的数据。

![](img/1c71155de356fd211c1d20b0eabdb6d7_51.png)

它也会经常错过正确的数据，得到不正确的数据并导致模型输出错误的东西，微调是一种相反的提示，所以你实际上可以容纳几乎无限量的数据，这很好，因为模型可以在数据上学习新的信息，结果。

你可以纠正它以前可能学到的不正确的信息，甚至放入它以前没有了解到的最近的信息，事后花费较少，如果你做得很好，调谐较小的模型，如果你想用很长时间来测试这个模型，这一点尤其重要，所以有很多吞吐量。

或者你希望它能处理更大的负载，而且检索增强生成也可以在这里使用。

![](img/1c71155de356fd211c1d20b0eabdb6d7_53.png)

我想有时人们认为这是一件单独的事情，但实际上你可以用它来处理这两种情况，所以你也可以把它和更多的数据连接起来。



![](img/1c71155de356fd211c1d20b0eabdb6d7_55.png)

即使它知道了所有这些信息，有缺点，但是，你需要更多的数据，数据必须有更高的质量才能开始。

![](img/1c71155de356fd211c1d20b0eabdb6d7_57.png)

还有一个前期计算成本，所以不一定是免费的，这不仅仅是几块钱刚开始，当然，现在有免费的工具可以开始，但实现这一目标所涉及的计算机远不止是提示。



![](img/1c71155de356fd211c1d20b0eabdb6d7_59.png)

通常你需要一些技术知识来把数据放在正确的地方，尤其是你知道，围绕着这个数据片段。

![](img/1c71155de356fd211c1d20b0eabdb6d7_61.png)

你知道现在有越来越多的工具，那就容易多了。

![](img/1c71155de356fd211c1d20b0eabdb6d7_63.png)

但你仍然需要对这些数据有所了解，而你没有，你不必只是一个会发短信的人。

![](img/1c71155de356fd211c1d20b0eabdb6d7_65.png)

必要的，所以最后这意味着。

![](img/1c71155de356fd211c1d20b0eabdb6d7_67.png)

你知道这对通用用例很好，它非常适合不同的附带项目和原型。

![](img/1c71155de356fd211c1d20b0eabdb6d7_69.png)

刚开始就很棒，真的真的很快，同时，微调对于更多的企业或领域特定用例来说是很好的。

![](img/1c71155de356fd211c1d20b0eabdb6d7_71.png)

并用于生产用途。

![](img/1c71155de356fd211c1d20b0eabdb6d7_73.png)

我们还将讨论如何，在下一节中，它对隐私很有用，这就是微调自己LLM的好处。

![](img/1c71155de356fd211c1d20b0eabdb6d7_75.png)

所以如果你有自己的LLM，你微调了，你得到的一个好处是性能，所以这可以阻止LLM编造东西，尤其是在你的地盘上，它在这个领域可以有更多的专业知识，它可以更加一致，所以有时这些模型会产生，你知道吗。

今天有件很棒的事，但明天你就成功了，而且不再一致了，它不再给你那么大的产量了，因此，这是一种实际上使它更加一致和可靠的方法，你也可以让它更好地调节，如果你和气BT玩过很多，你可能见过Chachi BG。

说，对不起，我无法回应，你可以让它说同样的事情或不同的事情，这与您的公司或用例有关，以帮助与之聊天的人。



![](img/1c71155de356fd211c1d20b0eabdb6d7_77.png)

一次又一次地保持正轨，所以现在我想谈谈隐私，当你微调你自己的生命。

![](img/1c71155de356fd211c1d20b0eabdb6d7_79.png)

这可能发生在您的VPC中，或者前提，嗯，这可以防止数据泄漏。

![](img/1c71155de356fd211c1d20b0eabdb6d7_81.png)

以及可能发生的数据泄露，第三方解决方案。

![](img/1c71155de356fd211c1d20b0eabdb6d7_83.png)

所以这是保护数据安全的一种方法，你已经收集了一段时间了，那可能是最后几天，也可能是最近几十年，另一个你可能想要微调自己的LLM的原因是成本，一个是成本透明度，也许你有很多人使用你的模型。



![](img/1c71155de356fd211c1d20b0eabdb6d7_85.png)

您实际上希望降低每个请求的成本，然后微调一个较小的LLM实际上可以帮助你做到这一点。

![](img/1c71155de356fd211c1d20b0eabdb6d7_87.png)

总的来说，你对成本和其他几个因素有更大的控制。

![](img/1c71155de356fd211c1d20b0eabdb6d7_89.png)

这包括正常运行时间和延迟，您可以大大减少某些应用程序（如自动完成）的延迟，您可能需要低于200毫秒的延迟，这样做自动完成的人就感觉不到了，您可能不希望自动完成发生在30秒内。

目前运行GPT 4有时就是这种情况，最后是适度的，我们在这里已经讨论过了。

![](img/1c71155de356fd211c1d20b0eabdb6d7_91.png)

但基本上，如果你想让模特对某些事情说对不起。

![](img/1c71155de356fd211c1d20b0eabdb6d7_93.png)

或者说我对某些事情不知道，甚至有一个自定义的响应，这是一种为模型提供护栏的方法，最酷的是，你真的可以在笔记本上看到一个例子。



![](img/1c71155de356fd211c1d20b0eabdb6d7_95.png)

所以在所有这些不同的实验室里，你将使用许多不同的技术来微调。

![](img/1c71155de356fd211c1d20b0eabdb6d7_97.png)

所以有三个Python库，一种是由meta开发的pytorch。

![](img/1c71155de356fd211c1d20b0eabdb6d7_99.png)

这是您将看到的最低级别的接口，然后是一个很棒的图书馆，把脸抱在圆周率火炬上，许多伟大的工作已经完成。

![](img/1c71155de356fd211c1d20b0eabdb6d7_101.png)

而且水平要高得多，您可以非常容易地导入数据集和训练模型，最后你会看到美洲驼图书馆，我和我的团队一直在开发，我们称它为美洲驼图书馆，为所有伟大的美洲驼服务。



![](img/1c71155de356fd211c1d20b0eabdb6d7_103.png)

这是一个更高级别的接口，在那里你可以用三行代码训练模型好的。

![](img/1c71155de356fd211c1d20b0eabdb6d7_105.png)

所以让我们跳到笔记本上，并看到一些微调模型在行动。

![](img/1c71155de356fd211c1d20b0eabdb6d7_107.png)

好啦，所以我们要比较一个微调模型和一个非微调模型。

![](img/1c71155de356fd211c1d20b0eabdb6d7_109.png)

首先，我们再次从美洲驼库导入。

![](img/1c71155de356fd211c1d20b0eabdb6d7_111.png)

这是美洲驼的，基本模型转轮，这门课所做的就是。

![](img/1c71155de356fd211c1d20b0eabdb6d7_113.png)

它帮助我们运行开源模型，所以这些都是托管在Gpus上运行的开源模型。

![](img/1c71155de356fd211c1d20b0eabdb6d7_115.png)

有效地运行它们，你可以在这里运行的第一个模型是美洲驼模型。

![](img/1c71155de356fd211c1d20b0eabdb6d7_117.png)

现在很流行，而且这个没有微调。

![](img/1c71155de356fd211c1d20b0eabdb6d7_119.png)

所以我们要实例化它，基于此，它的拥抱脸名字，我们会说，告诉我如何训练我的狗坐下来，所以这只是，你知道的，这里真的真的很简单，进入非微调模型，我们要把输出输出出来，让我们打印出来。



![](img/1c71155de356fd211c1d20b0eabdb6d7_121.png)

输出并查看，好啦，所以我们问它，告诉我怎么训练我的狗坐，它说期间，然后告诉我怎么训练我的狗说。

![](img/1c71155de356fd211c1d20b0eabdb6d7_123.png)

告诉我怎么教我的狗来，告诉我怎么让我的狗痊愈，如此明显。

![](img/1c71155de356fd211c1d20b0eabdb6d7_125.png)

这与，你的名字是什么？你姓什么？回答，这个模型没有被告知或训练来实际响应该命令。

![](img/1c71155de356fd211c1d20b0eabdb6d7_127.png)

也许有点灾难，但让我们继续寻找，所以说，也许我们可以问它，你觉得火星怎么样。

![](img/1c71155de356fd211c1d20b0eabdb6d7_129.png)

所以现在你知道了，至少它回答了这个问题。

![](img/1c71155de356fd211c1d20b0eabdb6d7_131.png)

但这不是很好的反应，我认为这是一个伟大的星球，我认为这是一个好星球，我想这将是一个伟大的星球。

![](img/1c71155de356fd211c1d20b0eabdb6d7_133.png)

所以它一直很有哲理，甚至可能存在。

![](img/1c71155de356fd211c1d20b0eabdb6d7_135.png)

如果你继续读下去，像谷歌搜索查询这样的东西怎么样。

![](img/1c71155de356fd211c1d20b0eabdb6d7_137.png)

就像泰勒·斯威夫特最好的朋友，让我们看看它到底说了什么好吧，嗯，呃，泰勒最好的朋友，但是嗯，上面说这是泰勒·斯威夫特的超级粉丝，嗯，让我们继续探索，也许是一些可以看到的对话。



![](img/1c71155de356fd211c1d20b0eabdb6d7_139.png)

如果它能在像Chachi BT这样的对话中转弯，这是亚马逊送货订单的代理，好啦，所以至少它在这里做了不同的客户代理，但它并没有从中得到什么，这不是任何类型的可用的东西，比如假转弯或者帮助做一个汽车代理。



![](img/1c71155de356fd211c1d20b0eabdb6d7_141.png)

所以你已经看够了，让我们把它和美洲驼二号进行比较。

![](img/1c71155de356fd211c1d20b0eabdb6d7_143.png)

已经被微调成真正的聊天，所以我将实例化微调模型，注意这个名字，一切都不一样，是在这里聊天吗，然后我要让这个微调模型做同样的事情，所以告诉我怎么训练我的狗坐着，我要把它打印出来。



![](img/1c71155de356fd211c1d20b0eabdb6d7_145.png)

好啦，很有意思，所以你可以立即看出，所以告诉我如何训练我的医生说，它还在尝试自动完成，所以告诉我如何训练我的狗听命令坐着，但实际上它几乎是一步一步地，做什么的指南，训练我的狗冷静，这样好多了。

而真正摆脱这种额外的自动完成的方法，实际上是通知模型你需要指示，所以我把这些指示标签放在这里，这也是用来对付美洲驼的，当你微调自己的模型时，你可以使用不同的东西，但这有助于告诉模型，嘿嘿。

这些是我的指示，这些是界限，我受够了停止这个指令，停止，继续给我指示。

![](img/1c71155de356fd211c1d20b0eabdb6d7_147.png)

所以在这里你可以看到它不会自动完成，听命行事，为了公平起见，我们可以用这个，非微调模型实际上说得很好，它只是重复同样的事情或非常相似的事情，所以嗯，不太对，酷，我们继续往下走。

那么你觉得火星这个模型怎么样。

![](img/1c71155de356fd211c1d20b0eabdb6d7_149.png)

哎呦，这是一个迷人的星球，几个世纪以来人类的想象力，好啦，酷，所以这里输出的东西要好得多，泰勒·斯威夫特最好的朋友呢，让我们看看这个怎么样，好啦，这个很可爱，它有几个候选人，呃。

泰勒·斯威夫特最好的朋友，其实是，让我们来看看亚马逊送货代理的这些转变，好啦，上面写着，原来如此，你能给我你的订单号吗，这样好多了，它很有趣，因为在这里它也总结了正在发生的事情。



![](img/1c71155de356fd211c1d20b0eabdb6d7_151.png)

你知道这可能是你想要的，也可能不是，这将是你可以微调的东西。

![](img/1c71155de356fd211c1d20b0eabdb6d7_153.png)

现在我很好奇，聊天GPT会说什么，告诉我怎么训练我的狗坐着。

![](img/1c71155de356fd211c1d20b0eabdb6d7_155.png)

好啦，所以它给了，你也知道不同的步骤，好极了，好啦，请随意使用Chachi或任何其他模型来查看，他们还能做什么并比较结果，但很明显，我认为那些经过微调的，包括查奇BT和这只美洲驼LLM。

他们显然比现在没有微调的那个好，在下一节课中，我们要看看微调在整个训练过程中的作用，所以你会看到如何到达这里的第一步。

