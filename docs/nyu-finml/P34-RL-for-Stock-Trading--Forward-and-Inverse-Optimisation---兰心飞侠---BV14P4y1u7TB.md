# P34：股票交易的强化学习 - 正向与反向优化 - 兰心飞侠 - BV14P4y1u7TB

现在，当我们为我们的问题定义了一步的风险调整和成本调整回报后，我们可以继续定义一个目标函数用于我们的投资组合优化问题。这个目标函数在方程式23中给出。像往常一样，它是所有未来时期的折扣一步回报总和的期望值。在这里，gamma是一个折扣因子，通常接近1。

我们可以将其视为一个无风险的折扣因子，用于一个时间步长和我们的投资组合问题。这个公式中最重要的部分是，这里显示的单步回报在状态xt和行动at上是二次的。优化问题的目标是在从t = 0到t = T - 1的行动at下，在一定约束条件下最大化这个表达式。一个约束是，两个分量a+和a-应当为非负值，这符合我们构建的含义。

此外，我们可能还会有其他的投资组合约束。我们可以使用一个通用符号at来表示一组对行动的约束，这些约束被称为交易约束。我们也可以有来自zt集合的约束，约束不同资产中新的持仓。请注意，求和不包括最后一步t，因为我们在上一期视频中看到，最后一步的行动是确定性的。

现在我们可以看到，我们问题中的词函数是xt和at的凸函数。因此，如果额外的约束集at和zt是凸的，那么整个问题是凸的，并且可以通过凸优化方法解决。这种设置在Stephen Boyd和Coathers撰写的名为《通过上下文优化进行多周期交易》的教程风格论文中得到了建议。该论文展示了许多实际有趣的投资组合优化设置可以在这种凸优化框架下进行考虑。

我会将这篇论文推荐给你以获取更多细节，并且只展示几个这样的凸约束示例。例如，养老金基金不能做空资产，因此对于它们，只有多头的约束在这里会是合适的。另一个例子适用于可以做空的机构。在这种情况下，通常会有对新头寸xt加上u团队的限制，这给出了限制性约束。

对总空头头寸的约束可以表示为一个杠杆约束。这个约束在这里的第三行中显示。它涉及所有头寸绝对值的总和。它超过所有头寸总和的部分称为杠杆。最后，我想提到的是这里最后一行显示的最低现金余额约束。

所有这些都将是凸约束的例子，即使在高维投资组合中也能保持问题的可处理性。好吧，接下来让我们总结一下这个框架，我们将其称为前向投资组合优化。在这种方法中，我们的任务是找到一个最优的投资组合交易策略。我们已知一个目标函数、约束条件以及投资组合的初始和终止条件。

这是一个典型的动态优化问题，如果已知模型，可以通过动态规划来解决。但如果模型在这种情况下涉及对预测因子zt的预测，这就变得困难，因为预测中的任何误差都会直接导致最优投资组合配置的误差。

为了说明这一切是如何运作的，让我们考虑这个形式化方法的一个特例，当步骤数仅为一步时。这样我们就可以讨论一步投资组合优化。在这个特例中，事情如预期般变得更简单。我们不再需要动态交易策略，而只需要一个仅涉及一步的策略。

在这种情况下，金融领域的人们通常谈论资产配置，因此资产配置的另一种说法就是单步策略。同样，我们需要在给定约束条件的情况下优化目标函数。如果我们将这种一步设置应用于一步投资组合优化问题，我们将得到1959年著名的市场投资组合模型。市场模型可能是金融领域最重要且应用最广泛的模型之一。

使用市场投资组合模型的从业人员非常清楚，实践中的主要挑战之一正是我们前面提到的那个问题。该模型在很大程度上依赖于我们对预测因子zt未来值的预测精度。

现在，存在一种非常优雅的方法来解决这个问题，即将优化问题翻转过来。这种方法被称为逆优化。逆优化的工作原理如下。假设我们已经知道了最优的投资组合配置。这意味着我们已经知道了优化问题的一个解。

现在我们可以问一下，产生如此最优配置的目标函数的参数是什么？对于一步投资组合市场的具体情况，它的优化也意味着我们需要取一个投资组合，并反转市场的最优投资组合公式，以便得到由观察到的最优解所暗示的预测因子zt的预测值。

这本质上是1992年著名的布莱克-利特曼模型的一种方法。布莱克和利特曼将市场投资组合优化问题应用于市场投资组合，例如标准普尔500指数投资组合，然后进行了反转。这为他们提供了市场本身如何预测未来预测因子zt值的见解。

原始的黑色利特曼模型并没有被表述为逆向优化，但这种表述在2012年由Bertzmas及其合作者提出。这些论文以及其他研究人员展示了如何使用黑色利特曼框架来评估仅对投资者而非市场其他参与者已知的私人信号zt的价值。

现在我们可以将相同的逆向优化方法推广到动态和多期的设置中。在这种情况下，我们不仅仅给出一个时间点的最优配置，而是给出一系列这样的再配置。也就是说，我们给出了一个动作历史。任务是找到一步奖励，或者在参数化设置中找到一步奖励的参数。另一个任务是找到一个与观察到的动作相对应的投资策略。

现在我们可以讨论两种可能的动态逆向投资组合优化设置。第一种情况是处理某个特定交易员或经纪人的专有投资组合和动作。第二种情况是我们查看市场投资组合。对于第二种情况，Sashi的方法将黑色利特曼分析推广到多期设置，并且可以用于与原始黑色利特曼模型相同的目的。

对于第一个案例，可以使用相同的方法来构建一个交易员的模型。现在，对于这两种情况，可以以相同的方式使用黑色利特曼模型来评估仅对投资者而非其他市场参与者已知的私人信号zt的价值。

但不同之处在于，现在我们分析的是预测因子zt在较长时间段内的影响，而不是一步黑色利特曼公式。这应该是件好事，因为多步投资组合表现是投资组合经理的最终目标。

如果他们能观察到信号在一段较长时间内的表现，这将平滑掉这种估算中的噪声，并可能有助于找到信号价值的更稳定估计。现在在这一点上，你可能会注意到，动态逆向优化的上述问题听起来与强化学习的目标非常相似，或者可能是逆向强化学习的目标。

这确实是事实，这意味着动态逆向投资组合优化可以使用强化学习和逆向强化学习中的工具来完成。我们将在下一个视频中讨论这些方法。

![](img/42f5da1301548ff9555c2c81a241e3e1_1.png)

[静音]。

![](img/42f5da1301548ff9555c2c81a241e3e1_3.png)
