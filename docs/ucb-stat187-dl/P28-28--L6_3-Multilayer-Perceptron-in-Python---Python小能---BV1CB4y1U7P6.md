# P28：28. L6_3 多层感知器在 Python 中的实现 - Python小能 - BV1CB4y1U7P6

所以让我们从零开始实现一个多层感知器（MLP）。我将做一些常规操作。你知道的，导入 nd array。

![](img/1043b15cf28850f9f82bab9eff0789a5_1.png)

我加载了新的数据集。其实这和之前的代码完全一样。

![](img/1043b15cf28850f9f82bab9eff0789a5_3.png)

所以这个部分应该完全无聊。现在更有趣的部分是，我开始初始化模型的参数。这个用于一个有一个隐藏层的深度网络。在这个隐藏层中，我假设有 256 个隐藏单元。所以第一个权重矩阵是输入乘以隐藏单元，第二个是隐藏单元乘以输出，对吧？

因为我需要适当地改变维度。所以我的偏置也相应地是隐藏单元的数量和输出的数量。换句话说，我的参数向量就是一个数组，包含 w1、w2 和 b2。所以现在我做的就是迭代所有这些参数。

将梯度附加到每一个参数上，因为我们需要对它们进行学习。

![](img/1043b15cf28850f9f82bab9eff0789a5_5.png)

然后我需要发明我的值。这个函数的作用仅仅是返回 0 和 x 之间的最大值。由于广播机制，它将始终返回与之前相同结构的对象。好了，做这个吧。

![](img/1043b15cf28850f9f82bab9eff0789a5_7.png)

我是不是……对，我已经初始化了这个。

![](img/1043b15cf28850f9f82bab9eff0789a5_9.png)

好的，很好。我的模型非常简单。我首先将 x 展平，因为最初它是一个 28x28 的像素图像。所以我需要将其转换为一个单一的向量。这样我就可以对其进行重塑。其实这也叫做展平，但更通用的说法是重塑。然后 h 只是一个值，表示隐藏单元。

所以我将使用 x 和 W 加偏置之间的内积作为值，然后返回 h 和 w2 以及偏置之间的内积。实际上这和我们之前的简单 softmax 线性回归模型完全一样。只不过现在我们有了隐藏单元。哦不。

然后我……对，就这样。我唯一会“作弊”的地方是，我会使用内置的 softmax 损失函数，这跟微分稳定性有关。否则代码就会稍微有点繁琐。好了。

![](img/1043b15cf28850f9f82bab9eff0789a5_11.png)

但这和之前的损失函数完全一样。训练流程和训练代码其实跟之前看到的完全一样。

![](img/1043b15cf28850f9f82bab9eff0789a5_13.png)

所以就是这样，我现在为它提供了一个不同的网络。实际上，损失函数是相同的。十次迭代，仅此而已。而且参数集不同。所以在使用 glue 还是从零开始做事情之间唯一的区别是，在一个情况下，我从零开始实现了网络架构。

另一个案例。我只是在使用一些非常精细的东西。好的。如果你记得我们之前的损失，现在稍微有一点改善，对吧？

所以我们在。88。是的。

![](img/1043b15cf28850f9f82bab9eff0789a5_15.png)

大致就是我们到达的地方。所以这是由于更好的架构带来的改进。如果我再调整一下架构，进行几次迭代，可能会得到更好的结果。

![](img/1043b15cf28850f9f82bab9eff0789a5_17.png)

然后如果我看一下这些，这正是你所做的。

![](img/1043b15cf28850f9f82bab9eff0789a5_19.png)

如之前所说，嗯，从这张图来看真的很难判断它是否真的工作得更好，因为我们可能只获得了3-4%的改进，而且我们只展示了十个观察值，但，嗯，好吧。它现在犯了些略微不同的错误。所以假设，我想展示这个。

![](img/1043b15cf28850f9f82bab9eff0789a5_21.png)

好的。不同的东西，嗯，现在它会把kelts误认成包，但这也许算是进步。好了，关于如何从零开始构建MLP有问题吗？好的。

![](img/1043b15cf28850f9f82bab9eff0789a5_23.png)

很酷。那我们继续前进到——，[BLANK_AUDIO]。

![](img/1043b15cf28850f9f82bab9eff0789a5_25.png)

![](img/1043b15cf28850f9f82bab9eff0789a5_26.png)

[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]。[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]。

![](img/1043b15cf28850f9f82bab9eff0789a5_28.png)

[BLANK_AUDIO]，[BLANK_AUDIO]。

![](img/1043b15cf28850f9f82bab9eff0789a5_30.png)

[BLANK_AUDIO]，[BLANK_AUDIO]。

![](img/1043b15cf28850f9f82bab9eff0789a5_32.png)

[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]。

![](img/1043b15cf28850f9f82bab9eff0789a5_34.png)

[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]。

![](img/1043b15cf28850f9f82bab9eff0789a5_36.png)

[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]，[BLANK_AUDIO]。

![](img/1043b15cf28850f9f82bab9eff0789a5_38.png)
